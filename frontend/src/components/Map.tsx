
// import { map } from "framer-motion/m";

// const CustomMap = () => {
//     const mapDiv = useRef(null);

//     useEffect(() => {
//         initMap();
//     }, [])

//     async function initMap() {
//         await ymaps3.ready;
//         const {YMap, YMapDefaultSchemeLayer} = ymaps3;
    
//         const map = new YMap(
//             mapDiv.current,
//             {
//                 location: {
//                     center: [37.588144, 55.733842],
//                     zoom: 10
//                 }
//             }
//         );
//             map.addChild(new YMapDefaultSchemeLayer());
//     }

//     return( <div id="map" style="width: 600px; height: 400px" ref={mapDiv}>

//     </div>

//     )

// }

// export default CustomMap;

const yandexRoute = {
  "traffic_type": "realtime",
  "route": {
      "legs": [
          {
              "status": "OK",
              "steps": [
                  {
                      "length": 17.307196873088643,
                      "duration": 1.5534458542779401,
                      "mode": "driving",
                      "waiting_duration": 0,
                      "polyline": {
                          "points": [
                              [
                                  54.991313,
                                  73.365393
                              ],
                              [
                                  54.991321,
                                  73.365122
                              ]
                          ]
                      }
                  },
                  {
                      "length": 386.52422643386615,
                      "duration": 99.34790257759657,
                      "mode": "driving",
                      "waiting_duration": 0,
                      "polyline": {
                          "points": [
                              [
                                  54.991321,
                                  73.365122
                              ],
                              [
                                  54.991355,
                                  73.365059
                              ],
                              [
                                  54.991409,
                                  73.364976
                              ],
                              [
                                  54.991432,
                                  73.364943
                              ],
                              [
                                  54.991507,
                                  73.364862
                              ],
                              [
                                  54.991559,
                                  73.364813
                              ],
                              [
                                  54.991615,
                                  73.364767
                              ],
                              [
                                  54.99167,
                                  73.364731
                              ],
                              [
                                  54.991715,
                                  73.364708
                              ],
                              [
                                  54.991752,
                                  73.364696
                              ],
                              [
                                  54.991795,
                                  73.364691
                              ],
                              [
                                  54.991857,
                                  73.364687
                              ],
                              [
                                  54.992277,
                                  73.364701
                              ],
                              [
                                  54.99244,
                                  73.364711
                              ],
                              [
                                  54.992679,
                                  73.364722
                              ],
                              [
                                  54.992933,
                                  73.364733
                              ],
                              [
                                  54.993196,
                                  73.364748
                              ],
                              [
                                  54.993269,
                                  73.364751
                              ],
                              [
                                  54.993358,
                                  73.364755
                              ],
                              [
                                  54.993433,
                                  73.364758
                              ],
                              [
                                  54.994046,
                                  73.364787
                              ],
                              [
                                  54.994626,
                                  73.364821
                              ],
                              [
                                  54.994719,
                                  73.364824
                              ]
                          ]
                      }
                  },
                  {
                      "length": 867.6448095553242,
                      "duration": 174.0804858615938,
                      "mode": "driving",
                      "waiting_duration": 0,
                      "polyline": {
                          "points": [
                              [
                                  54.994719,
                                  73.364824
                              ],
                              [
                                  54.994716,
                                  73.364946
                              ],
                              [
                                  54.99471,
                                  73.365474
                              ],
                              [
                                  54.994699,
                                  73.365736
                              ],
                              [
                                  54.994691,
                                  73.366057
                              ],
                              [
                                  54.994671,
                                  73.366672
                              ],
                              [
                                  54.994644,
                                  73.367576
                              ],
                              [
                                  54.994639,
                                  73.367725
                              ],
                              [
                                  54.994618,
                                  73.368389
                              ],
                              [
                                  54.994607,
                                  73.368683
                              ],
                              [
                                  54.994598,
                                  73.368985
                              ],
                              [
                                  54.994589,
                                  73.369223
                              ],
                              [
                                  54.994581,
                                  73.369484
                              ],
                              [
                                  54.994546,
                                  73.370462
                              ],
                              [
                                  54.994521,
                                  73.371247
                              ],
                              [
                                  54.994515,
                                  73.371482
                              ],
                              [
                                  54.994491,
                                  73.372238
                              ],
                              [
                                  54.994487,
                                  73.372388
                              ],
                              [
                                  54.994484,
                                  73.372524
                              ],
                              [
                                  54.99448,
                                  73.372623
                              ],
                              [
                                  54.994472,
                                  73.372869
                              ],
                              [
                                  54.994462,
                                  73.373405
                              ],
                              [
                                  54.994443,
                                  73.374113
                              ],
                              [
                                  54.994431,
                                  73.374431
                              ],
                              [
                                  54.994424,
                                  73.374559
                              ],
                              [
                                  54.994415,
                                  73.374664
                              ],
                              [
                                  54.994395,
                                  73.374815
                              ],
                              [
                                  54.994383,
                                  73.374889
                              ],
                              [
                                  54.994353,
                                  73.37506
                              ],
                              [
                                  54.994333,
                                  73.375159
                              ],
                              [
                                  54.994011,
                                  73.376535
                              ],
                              [
                                  54.993989,
                                  73.376634
                              ],
                              [
                                  54.993965,
                                  73.376751
                              ],
                              [
                                  54.99393,
                                  73.376942
                              ],
                              [
                                  54.993908,
                                  73.377135
                              ],
                              [
                                  54.993889,
                                  73.377345
                              ],
                              [
                                  54.993826,
                                  73.377891
                              ],
                              [
                                  54.993803,
                                  73.378066
                              ],
                              [
                                  54.993779,
                                  73.378213
                              ]
                          ]
                      }
                  },
                  {
                      "length": 1259.3992786649117,
                      "duration": 165.25949971654393,
                      "mode": "driving",
                      "waiting_duration": 0,
                      "polyline": {
                          "points": [
                              [
                                  54.993779,
                                  73.378213
                              ],
                              [
                                  54.993633,
                                  73.378311
                              ],
                              [
                                  54.993453,
                                  73.378422
                              ],
                              [
                                  54.993403,
                                  73.378457
                              ],
                              [
                                  54.993372,
                                  73.378487
                              ],
                              [
                                  54.993351,
                                  73.37851
                              ],
                              [
                                  54.993316,
                                  73.378556
                              ],
                              [
                                  54.993304,
                                  73.378585
                              ],
                              [
                                  54.993244,
                                  73.378694
                              ],
                              [
                                  54.993199,
                                  73.378793
                              ],
                              [
                                  54.99279,
                                  73.379745
                              ],
                              [
                                  54.992773,
                                  73.379813
                              ],
                              [
                                  54.992767,
                                  73.379862
                              ],
                              [
                                  54.992762,
                                  73.37994
                              ],
                              [
                                  54.992763,
                                  73.379984
                              ],
                              [
                                  54.992765,
                                  73.380019
                              ],
                              [
                                  54.992775,
                                  73.380066
                              ],
                              [
                                  54.992786,
                                  73.380103
                              ],
                              [
                                  54.992807,
                                  73.380143
                              ],
                              [
                                  54.992947,
                                  73.380311
                              ],
                              [
                                  54.993061,
                                  73.380442
                              ],
                              [
                                  54.993207,
                                  73.380612
                              ],
                              [
                                  54.993308,
                                  73.380729
                              ],
                              [
                                  54.99348,
                                  73.380928
                              ],
                              [
                                  54.993805,
                                  73.381308
                              ],
                              [
                                  54.994157,
                                  73.381711
                              ],
                              [
                                  54.99437,
                                  73.381941
                              ],
                              [
                                  54.99448,
                                  73.382059
                              ],
                              [
                                  54.994746,
                                  73.382321
                              ],
                              [
                                  54.994852,
                                  73.382424
                              ],
                              [
                                  54.99513,
                                  73.382705
                              ],
                              [
                                  54.995151,
                                  73.382726
                              ],
                              [
                                  54.995321,
                                  73.38289
                              ],
                              [
                                  54.995588,
                                  73.383159
                              ],
                              [
                                  54.995791,
                                  73.383363
                              ],
                              [
                                  54.995848,
                                  73.383423
                              ],
                              [
                                  54.996023,
                                  73.383601
                              ],
                              [
                                  54.996168,
                                  73.383759
                              ],
                              [
                                  54.996324,
                                  73.383921
                              ],
                              [
                                  54.99653,
                                  73.384134
                              ],
                              [
                                  54.996681,
                                  73.384289
                              ],
                              [
                                  54.996798,
                                  73.384416
                              ],
                              [
                                  54.996894,
                                  73.384514
                              ],
                              [
                                  54.9971,
                                  73.384731
                              ],
                              [
                                  54.997189,
                                  73.384821
                              ],
                              [
                                  54.997587,
                                  73.385243
                              ],
                              [
                                  54.998479,
                                  73.386195
                              ],
                              [
                                  54.998562,
                                  73.386284
                              ],
                              [
                                  54.999068,
                                  73.386831
                              ],
                              [
                                  54.999182,
                                  73.386951
                              ],
                              [
                                  54.999775,
                                  73.387583
                              ],
                              [
                                  54.999844,
                                  73.387658
                              ],
                              [
                                  54.999913,
                                  73.387733
                              ],
                              [
                                  55.000046,
                                  73.387877
                              ],
                              [
                                  55.00016,
                                  73.388
                              ],
                              [
                                  55.000424,
                                  73.388289
                              ],
                              [
                                  55.000741,
                                  73.388632
                              ],
                              [
                                  55.001074,
                                  73.388983
                              ]
                          ]
                      }
                  },
                  {
                      "length": 265.61430760817666,
                      "duration": 48.847588201466124,
                      "mode": "driving",
                      "waiting_duration": 0,
                      "polyline": {
                          "points": [
                              [
                                  55.001074,
                                  73.388983
                              ],
                              [
                                  55.001047,
                                  73.389062
                              ],
                              [
                                  55.000462,
                                  73.390728
                              ],
                              [
                                  55.000431,
                                  73.390813
                              ],
                              [
                                  55.000409,
                                  73.39087
                              ],
                              [
                                  54.99981,
                                  73.392511
                              ]
                          ]
                      }
                  }
              ]
          }
      ],
      "flags": {
          "hasTolls": false,
          "hasNonTransactionalTolls": false
      }
  }
}


const dataRoute = {
  "routes": [
    {
      "weight_name": "pedestrian",
      "weight": 2325.743,
      "duration": 1620.805,
      "distance": 2213.01,
      "legs": [
        {
          "via_waypoints": [],
          "admins": [{"iso_3166_1_alpha3": "RUS", "iso_3166_1": "RU"}],
          "weight": 2325.743,
          "duration": 1620.805,
          "steps": [],
          "distance": 2213.01,
          "summary": "Госпитальная улица, 1-я Береговая улица"
        }
      ],
      "geometry": {
        "coordinates": [
          [73.368002, 54.991924],
          [73.368071, 54.991923],
          [73.368191, 54.991922],
          [73.368245, 54.991921],
          [73.368379, 54.991921],
          [73.368431, 54.991919],
          [73.368583, 54.991916],
          [73.368729, 54.991913],
          [73.368744, 54.992277],
          [73.368753, 54.992501],
          [73.369234, 54.992493],
          [73.369238, 54.992572],
          [73.37021, 54.992553],
          [73.370554, 54.992547],
          [73.370678, 54.992545],
          [73.372002, 54.992517],
          [73.372203, 54.992513],
          [73.372282, 54.993104],
          [73.372422, 54.993101],
          [73.37246, 54.993101],
          [73.372563, 54.993096],
          [73.372958, 54.993088],
          [73.373319, 54.993076],
          [73.373506, 54.993069],
          [73.374635, 54.993004],
          [73.3748, 54.992992],
          [73.374903, 54.992972],
          [73.375298, 54.992833],
          [73.375413, 54.992793],
          [73.376066, 54.9934],
          [73.3766, 54.993897],
          [73.376698, 54.993987],
          [73.376797, 54.994081],
          [73.377064, 54.994047],
          [73.378263, 54.9939],
          [73.37877, 54.993813],
          [73.379445, 54.993728],
          [73.380574, 54.993557],
          [73.380757, 54.99355],
          [73.380897, 54.993566],
          [73.381079, 54.993637],
          [73.382106, 54.994566],
          [73.382292, 54.994777],
          [73.382404, 54.994883],
          [73.382698, 54.995162],
          [73.383152, 54.995595],
          [73.383372, 54.995804],
          [73.383402, 54.995833],
          [73.383601, 54.996022],
          [73.383922, 54.996328],
          [73.384843, 54.997209],
          [73.386017, 54.996785],
          [73.38615, 54.996787],
          [73.386397, 54.996815],
          [73.386687, 54.996872],
          [73.3878, 54.997209],
          [73.388277, 54.99734],
          [73.388572, 54.997496],
          [73.388626, 54.997527],
          [73.388678, 54.997572],
          [73.388845, 54.997563],
          [73.388963, 54.997572],
          [73.389076, 54.997607],
          [73.389506, 54.997752],
          [73.389881, 54.997865],
          [73.390302, 54.997962],
          [73.390455, 54.997999],
          [73.391311, 54.998206],
          [73.391463, 54.998313],
          [73.391342, 54.998348],
          [73.391145, 54.998528],
          [73.391839, 54.999158],
          [73.392522, 54.999813]
        ],
        "type": "LineString"
      }
    }
  ],
  "waypoints": [
    {"distance": 2.725, "name": "", "location": [73.368002, 54.991924]},
    {
      "distance": 2.017,
      "name": "Луганская улица",
      "location": [73.392522, 54.999813]
    }
  ],
  "code": "Ok",
  "uuid": "HIH8zDKNI3yPz0dZW1RV1nnox3gDY-Y8sNbxR5OhHMXk4FkA1ezETg=="
}

const polylinePoints = dataRoute?.routes[0]?.geometry?.coordinates.map(item => [...item])
const dataRes = { "route": {
  "legs": [
      {
          "status": "OK",
          "steps": [
              {
                  "length": 17.307196873088643,
                  "duration": 1.5534458542779401,
                  "mode": "driving",
                  "waiting_duration": 0,
                  "polyline": {points: polylinePoints},
              }
            ]
          }
      ]
  }
}





import {YMap, YMapDefaultSchemeLayer, YMapDefaultFeaturesLayer, YMapMarker, reactify, YMapDefaultMarker, YMapFeature} from './lib/ymap';
import { useEffect, useState, useCallback } from "react";
import {fetchRoute} from '../helpers/fetchRoute';
// import type {YMapLocationRequest} from 'ymaps3';

const LOCATION = {
  center: [37.588144, 55.733842],
  zoom: 9
};

const LINE_STYLE = {
  simplificationRate: 0,
  stroke: [
    {width: 7, color: '#83C753'},
    {width: 9, color: '#000000', opacity: 0.3}
  ]
};


const dataRes2 = {
  geometry: {
    type: 'LineString',
    coordinates: polylinePoints,
  },
  style: {
    stroke: [{width: 12, color: 'rgb(14, 194, 219)'}]
  }
}

const coordsHopper =  [[
  73.368071,
  54.991923
],
[
  73.36838,
  54.991921
],
[
  73.368729,
  54.991913
],
[
  73.368753,
  54.992501
],
[
  73.370549,
  54.992469
],
[
  73.370554,
  54.992547
],
[
  73.372203,
  54.992513
],
[
  73.372282,
  54.993105
],
[
  73.37332,
  54.993076
],
[
  73.3748,
  54.992992
],
[
  73.374904,
  54.992972
],
[
  73.375298,
  54.992834
],
[
  73.375936,
  54.99345
],
[
  73.376019,
  54.993502
],
[
  73.376481,
  54.993936
],
[
  73.376443,
  54.993947
],
[
  73.376612,
  54.994153
],
[
  73.376657,
  54.994146
],
[
  73.377023,
  54.994467
],
[
  73.377077,
  54.994487
],
[
  73.377188,
  54.994446
],
[
  73.378976,
  54.996086
],
[
  73.379733,
  54.995815
],
[
  73.380627,
  54.996637
],
[
  73.381463,
  54.996338
],
[
  73.381814,
  54.996661
],
[
  73.383452,
  54.996075
],
[
  73.384689,
  54.997264
],
[
  73.384843,
  54.997209
],
[
  73.386017,
  54.996785
],
[
  73.38615,
  54.996787
],
[
  73.386397,
  54.996815
],
[
  73.386687,
  54.996872
],
[
  73.3878,
  54.99721
],
[
  73.388277,
  54.99734
],
[
  73.388626,
  54.997527
],
[
  73.388678,
  54.997572
],
[
  73.388845,
  54.997563
],
[
  73.388963,
  54.997573
],
[
  73.389506,
  54.997752
],
[
  73.389881,
  54.997865
],
[
  73.391312,
  54.998206
],
[
  73.391463,
  54.998313
],
[
  73.391342,
  54.998348
],
[
  73.391145,
  54.998528
],
[
  73.391839,
  54.999158
],
[
  73.392506,
  54.999798
]
]

const dataRes3 = {
  geometry: {
    type: 'LineString',
    coordinates: coordsHopper,
  },
  style: {
    stroke: [{width: 12, color: 'rgb(14, 194, 219)'}]
  }

}



const CustomMap = ({routeArr,  ...props}: {routeArr: any[]}) => {
    const [route, setRoute] = useState(dataRes);

    const handleRoute = useCallback((route) => {
        if (route){
            setRoute(route);
        } else {
            setRoute(null);
        }
    }, [routeArr]);
    useEffect(() => {
    }, [])
    

  return (
    <div style={{width: '100%', height: '400px'}}>
      <YMap location={reactify.useDefault(LOCATION)}>
        <YMapDefaultSchemeLayer />
        <YMapDefaultFeaturesLayer />
        <YMapDefaultSchemeLayer />
              {/* Add route start and end markers to the map */}
              <>
              {routeArr.map(( item) => {
                console.log('item:', item);
                 <YMapMarker coordinates={reactify.useDefault(item.coords)} draggable={false}>
                  <h2>Hello</h2>
                 </YMapMarker>
              }
              )}
              </>
              {route && <YMapFeature {...dataRes2} style={LINE_STYLE} 
              disableRoundCoordinates={false}
              />}
              {/* <YMapDefaultMarker
                coordinates={routeArr[0]}
                title="Point A"
                draggable
                size="normal"
                iconName="fallback"
                
              />
              <YMapDefaultMarker
                coordinates={routeArr[1]}
                title="Point B"
                draggable
                size="normal"
                iconName="fallback"
                
              /> */}

              {/* Add the route line to the map when it becomes available */}
      </YMap>
    </div>
  );
}

export default CustomMap;